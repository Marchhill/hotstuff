% The introduction should explain the principal motivation for the project and show how the work fits into the broad area of surrounding computer science and give a brief survey of previous related work. It should generally be unnecessary to quote at length from technical papers or textbooks. If a simple bibliographic reference is insufficient, consign any lengthy quotation to an appendix.

% 	importance of Blockchains
% 	My contributions:
% 	reference implementation in OCaml
% 	problems I faced
% 	more complete specification of HS

The power of blockchains lies in their ability to decentralise applications that were traditionally run in a centralised manner. The implications of this are far-reaching: central banks can be replaced by decentralised cryptocurrencies, traditional corporations can be replaced with decentralised autonomous organisations (DAOs), internet infrastructure like DNS servers can be decentralised, and any possible algorithm can be run on a decentralised `world computer'. The innovation that make blockchains possible is the byzantine consensus algorithm.

Byzantine fault-tolerant consensus algorithms allows a group of parties to agree on some piece of information under adverse conditions where some messages can be lost and some parties are controlled by a malicious adversary. For example, one could create a cryptocurrency by using such an algorithm to reach consensus between many devices on a ledger of transactions like ``Account Alice transfers account Bob £10''; the algorithm will ensure that transactions cannot be lost and the system cannot be sabotaged by malicious actors.

Byzantine consensus algorithms can be viewed as solutions to the byzantine generals problem \cite{lamport_byzantine_nodate}. In this problem, a group of generals must all agree to siege a castle at the same time, but they can only communicate via messengers that take some time to arrive and can be captured en route. Additionally, up to a third of the generals may be malicious, and try to prevent the other generals from reaching consensus on a time to attack. By following a byzantine consensus protocol the generals can reach consensus on a value like ``attack at dawn''. Some algorithms can reach consensus on multiple values, resulting in a continuously growing log that can never be modified or erased, only extended.

Blockchains can be either permissioned, or permissionless. Permissioned blockchains have a previously agreed set of participants in the consensus algorithm, whereas permissionless blockchains allow participants to join and leave freely. Most well-known blockchains, such as Bitcoin \cite{nakamoto_bitcoin_nodate} and Ethereum \cite{wood_ethereum_nodate}, are of the permissionless variety. Permissioned blockchains can be deployed in a permissionless setting if they are augmented with an additional layer of security, which can be proof of work, proof of stake, or some other similar mechanism. These aim to prevent a `Sybil attack' where a permissioned blockchain can be overrun by a large number of malicious nodes; proof of work, for example, adds a requirement for a proof of computational work in order to participate in consensus, making Sybil attacks economically and computationally infeasible. Permissioned blockchains are of interest for applications within a group or organisation, such as a company, where the participating nodes are known in advance.

HotStuff is a byzantine consensus algorithm that was notably used by Meta's Libra project \cite{baudet_state_nodate}, a cancelled permissioned blockchain-based payments system. The algorithm is relevant because of various performance advantages over other byzantine consensus algorithms such as PBFT \cite{castro_practical_nodate}, SBFT \cite{golan_gueta_sbft_2019}, DLS \cite{dwork_consensus_nodate}, Tendermint \cite{kwon_tendermint_nodate}, and Casper \cite{buterin_casper_2019}.

% Blockchains generally provide anonymity or pseudonymity; some privacy cryptocurrencies like Monero use zero-knowledge proofs to make transactions anonymous and unlinkable. This has the advantage of protecting the privacy of internet users, and allowing them to them to evade censorship and surveillance by tyrannical regimes. However this anonymity can also facilitate unethical behaviour such as money laundering, and the trade of illicit goods like firearms. A potential solution to this problem are verifiable anonymous identities, in which the participants are anonymous in most cases, but identities can be verified when a transaction is called into question (eg. due to a regulatory requirement).

Building practical, well-performing implementations of consensus algorithms is highly non-trivial. These algorithms are usually specified in short pieces of pseudocode that may not be specified precisely and require much more code to implement in practice. Such software has a wide range of failure modes mostly due to their parallel nature, including deadlocks, resource starvation, and bugs in the implementation \cite{chubby}.

The main contributions of this dissertation are:
\begin{itemize}
	\item Providing a reference implementation of HotStuff in OCaml based on a paper by Yin et. ~al~ \cite{yin2019hotstuff}.
	\item Synthesising information from different sources to provide a complete explanation of the HotStuff algorithm, and how it can be arrived at through modifications to simpler consensus algorithms (basic algorithm section \ref{hotstufftheory}, chained algorithm section \ref{chaining}, pacemaker section \ref{pacemaker}).
	\item Giving solutions to key practical challenges of implementation and optimisations that can be made (section \ref{performance}), as well as showing their effectiveness (section \ref{ablation})
	\item Giving a complete specification and proof of HotStuff (section \ref{spec}), that adapts the pacemaker mechanism which was not sufficiently specified in the original paper. This specification synthesises the chained algorithm described in the paper (section \ref{chaining}), a view-change protocol based on other talks and papers (section \ref{viewchange}), and our own changes that allow the algorithm to work in environments without synchronised clocks.
	% \item Adapting the pacemaker mechanism presented in the HotStuff paper, giving a full specification that works in asynchronous environments without synchronised clocks. The paper did not sufficiently specify the pacemaker mechanism, which drives the system to ensure it makes progress.
\end{itemize}
% Blockchains are exciting because of their potential to decentralise many applications that are traditionally centralised. These include:
% Central banks being replaced with decentralised cryptocurrencies 
% Centralised DNS servers being replaced with distributed ones
% Any possible algorithm that could run some algorithm on a centralised machine. This can be replaced with a decentralised virtual machine like the EVM that is Turing complete
% One example of this is an NFT which is a 'smart contract' implemented on the EVM. This is a program that maintains a list of unique (fungible) tokens and their corresponding owners. These tokens could correspond to a file stored on the internet (images, music, videos), possibly in a decentralised manner using IPFS, or with a physical object like a car that could be unlocked with the token. The program allows requests from owners to transfer to others.

% There are permissioned and permissionless blockchains. *Give examples of both and cases where they may be preferable to one another*

% The underlying algorithm of blockchains is known as consensus. *Informally describe the problem and system model and formalise later*

% They are pseudonymous, so can be used by people to hide their identity. They can be made completely anonymous like in currencies like Monero and Zcash by using zero knowledge succinct proofs. They have the benefits of protecting people's internet freedom, hiding their activities from oppressive governments, and removing the need to trust centralised authorities that could possibly be corrupt. They have the disadvantage of facilitating money laundering, and the trade of illicit materials (cite government’s position on blockchains and the silk road case study). They tend towards anarcho-capitalist systems with no regulation (cite play to earn games and darknet markets).

% One way to combat this is with verifiable anonymous identities, which could combine the benefits of anonymity with some level of control, accountability, (and democracy?) without the need of a centralised authority. Could verify that an individual has the right to vote eg. They can only vote once, that they are a member of some federated area (voting constituency), they are an eligible citizen of the correct age - without compromising voting anonymity. Could facilitate decentralised direct democracy and anarchic governance in an organisation, community, or society, such as: ownership of a company by a large number of people, voting on policy decisions, running an organisation with a flat hierarchy (like a union, cooperative?)

% Live testing revealed many subtle bugs, deadlocks, and performance issues (memory usage, messages dropped due to bugs preventing leaders from always advancing) that were time consuming to debug. However they helped me to flesh out a pacemaker algorithm based on these ad-hoc fixes that we have proven both correctness and liveness for. I also improved the ease of implementability based on practicalities I discovered during implementation (eg. using node offset and hashes to compare nodes)